import { useQuery } from 'react-query';
import { Client } from '@elastic/elasticsearch';

const client = new Client({ node: 'http://localhost:9200' }); // Replace with your Elasticsearch node URL

const fetchEvents = async (location, distance) => {
    const response = await client.search({
        index: 'events',
        body: {
            query: {
                bool: {
                    filter: {
                        geo_distance: {
                            distance: `${distance}km`,
                            location: {
                                lat: location[0], // Replace with the latitude of the point
                                lon: location[1], // Replace with the longitude of the point
                            },
                        },
                    },
                },
            },
        },
    });
    return response.hits.hits.map(hit => hit._source);
};

export const useGetEvents = (location, distance) => {
    return useQuery(['events'], () => fetchEvents(location, distance), {
        enabled: !!location, // Only run query if query is provided
    });
};